{"version":3,"sources":["index.js","tools/canvas_tools.js","app.js"],"names":["drawingPrimerFunction","_initCvs","ctx","width","height","fillStyle","strokeStyle","_primer","fillRect","backupStroke","beginPath","moveTo","lineTo","stroke","_drawRawOsc","data","i","length","x","y","MediaStreamOscilloscope","mediaStream","canvasElement","audioDest","analyzerFFT","canvasInitFunction","createAudioContext","src","createMediaStreamSource","Oscilloscope","audioContext","audioSource","actx","FFT","cvs","init","_ct","primer","paused","anl","createAnalyser","dest","fftSize","connect","WIDTH","HEIGHT","u8ar","Uint8Array","cctx","getContext","draw","requestAnimationFrame","clearRect","getByteTimeDomainData","start","pause","reset","fill","window","AudioContext","webkitAudioContext","fancyGraph","backstrokeStyle","j","startOsc","document","querySelector","navigator","mediaDevices","getUserMedia","audio","then","stream","osc","addEventListener"],"mappings":"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","file":"app.0deb5823.js","sourceRoot":"../example","sourcesContent":["\"use strict\";\nimport * as _ct from \"./tools/canvas_tools\";\nfunction Oscilloscope(audioContext, audioSource, canvasElement, audioDest = null, analyzerFFT = 2048, canvasInitFunction = null, drawingPrimerFunction = null){\n        this.actx   = audioContext;\n        this.FFT    = analyzerFFT;\n        this.cvs    = canvasElement;\n        this.init   = canvasInitFunction    || _ct._initCvs;\n        this.primer = drawingPrimerFunction || _ct._primer;\n        this.paused = false;\n        this.anl    = this.actx.createAnalyser();\n        this.ctx    = audioContext;\n        this.src    = audioSource;\n        this.dest   = audioDest;\n        // Configure Analyzer\n        this.anl.fftSize = this.FFT;\n        this.src.connect(this.anl);\n        if(this.dest) this.anl.connect(this.dest);\n        // Set up Canvas\n        let {width = 300, height = 150} = this.cvs;\n        this.WIDTH  = width;\n        this.HEIGHT = height;\n        this.u8ar = new Uint8Array(this.FFT);\n        this.cctx = this.cvs.getContext(\"2d\");\n        this.init(this.cctx,this.WIDTH,this.HEIGHT);\n        this.draw = () =>{\n            if(!this.paused) requestAnimationFrame(this.draw);\n            this.cctx.clearRect(0 , 0, this.WIDTH, this.HEIGHT);\n            this.primer(this.cctx, this.WIDTH, this.HEIGHT);\n            this.anl.getByteTimeDomainData(this.u8ar);\n            _ct._drawRawOsc(this.cctx, this.u8ar, this.WIDTH, this.HEIGHT);\n        }\n        this.start = () => {\n            this.paused = false;\n            this.draw();\n        }\n        this.pause = () =>{\n            this.paused = true;\n        }\n        this.reset = () =>{\n            this.paused = true;\n            requestAnimationFrame(()=>{\n                this.u8ar = new Uint8Array(this.FFT).fill(0);\n                this.cctx.clearRect(0 , 0, this.WIDTH, this.HEIGHT);\n                this.primer(this.cctx, this.WIDTH, this.HEIGHT);\n                _ct._drawRawOsc(this.cctx, this.u8ar, this.WIDTH, this.HEIGHT);\n            });\n        }\n}\n\nfunction createAudioContext(){\n    return new (window.AudioContext || window.webkitAudioContext)();\n}\n\nfunction MediaStreamOscilloscope(mediaStream, canvasElement, audioDest = null, analyzerFFT = 2048, canvasInitFunction = null, drawingPrimerFunction = null){\n    let ctx = createAudioContext();\n    let src = ctx.createMediaStreamSource(mediaStream);\n    return new Oscilloscope(ctx, src, canvasElement, audioDest, analyzerFFT, canvasInitFunction, drawingPrimerFunction);\n}\nexport {\n    Oscilloscope,\n    MediaStreamOscilloscope,\n    createAudioContext\n}","function _initCvs(ctx, width, height){\n    ctx.fillStyle   = \"#000\";\n    ctx.strokeStyle = \"#0f0\";\n}\nfunction _primer(ctx, width, height){\n    ctx.fillRect(0,0,width,height);\n    let backupStroke = ctx.strokeStyle;\n    ctx.strokeStyle = \"#777\";\n    ctx.beginPath();\n    ctx.moveTo(0, height / 2);\n    ctx.lineTo(width, height / 2);\n    ctx.stroke();\n    ctx.strokeStyle = backupStroke;\n}\nfunction _drawRawOsc(ctx,data,width,height){\n    ctx.beginPath();\n    for(let i=0; i < data.length; i++){\n        let x = i * (width * 1.0 / data.length); // need to fix x\n        let v = data[i] / 128.0;\n        let y = v * height / 2;\n        if(i === 0) ctx.moveTo(x,y);\n        else ctx.lineTo(x,y);\n    }\n    ctx.stroke();\n}\nexport {\n    _initCvs,\n    _primer,\n    _drawRawOsc\n}","import {MediaStreamOscilloscope} from \"../dist/index\";\nfunction fancyGraph(ctx,width,height){\n    let backstrokeStyle = ctx.strokeStyle;\n    ctx.strokeStyle = \"#444\";\n    ctx.fillRect(0,0,width,height);\n    ctx.beginPath();\n    for(let i=0; i<width; i+=10){\n        ctx.moveTo(i,0);\n        ctx.lineTo(i,height);\n    }\n    for(let j=0; j<height; j+=10){\n        ctx.moveTo(0,j);\n        ctx.lineTo(width,j);\n    }\n    ctx.stroke();\n    ctx.strokeStyle = backstrokeStyle;\n}\nfunction startOsc(){\n    let cvs = document.querySelector(\".cvs\");\n    navigator.mediaDevices.getUserMedia({audio: true})\n        .then(stream=>{\n            let osc = new MediaStreamOscilloscope(stream, cvs, null, 2048, null, fancyGraph);\n            osc.start();\n            document.querySelector(\".btn.pause\").addEventListener(\"click\",osc.pause);\n            document.querySelector(\".btn.reset\").addEventListener(\"click\",osc.reset);\n        });\n}\ndocument.querySelector(\".start\").addEventListener(\"click\",startOsc);"]}